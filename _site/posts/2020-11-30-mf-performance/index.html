<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ashwin Malshe">
<meta name="dcterms.date" content="2020-11-30">
<meta name="description" content="In this article, I reproduce Figure 1 from Mark Carhart’s classic 1997 Journal of Finance article titled “On Persistence in Mutual Fund Performance”. The visualizations are created using highcharter and echarts4r packages. It is an interactive bar plot that shows that there is a very low persistence in the mutual fund performance.">

<title>Persistence in Mutual Fund Performance – Dataviz Blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-7263b479674981c35f32fb4050188601.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<script src="../../site_libs/proj4js-2.3.15/proj4.js"></script>
<link href="../../site_libs/highcharts-9.3.1/css/motion.css" rel="stylesheet">
<script src="../../site_libs/highcharts-9.3.1/highcharts.js"></script>
<script src="../../site_libs/highcharts-9.3.1/highcharts-3d.js"></script>
<script src="../../site_libs/highcharts-9.3.1/highcharts-more.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/stock.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/map.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/data.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/exporting.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/offline-exporting.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/drilldown.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/item-series.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/overlapping-datalabels.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/annotations.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/export-data.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/funnel.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/heatmap.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/treemap.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/sankey.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/dependency-wheel.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/organization.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/solid-gauge.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/streamgraph.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/sunburst.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/vector.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/wordcloud.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/xrange.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/tilemap.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/venn.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/gantt.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/timeline.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/parallel-coordinates.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/bullet.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/coloraxis.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/dumbbell.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/lollipop.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/series-label.js"></script>
<script src="../../site_libs/highcharts-9.3.1/plugins/motion.js"></script>
<script src="../../site_libs/highcharts-9.3.1/custom/reset.js"></script>
<script src="../../site_libs/highcharts-9.3.1/modules/boost.js"></script>
<script src="../../site_libs/highchart-binding-0.9.4/highchart.js"></script>
<script src="../../site_libs/echarts4r-4.8.0/echarts-en.min.js"></script>
<script src="../../site_libs/echarts4r-4.8.0/ecStat.min.js"></script>
<script src="../../site_libs/echarts4r-4.8.0/dataTool.min.js"></script>
<script src="../../site_libs/echarts4r-binding-0.4.4/echarts4r.js"></script>
<script src="../../site_libs/echarts-gl-1.1.2/echarts-gl.min.js"></script>
<script src="../../site_libs/blue-1.0.0/blue.js"></script>
<script src="../../site_libs/highcharts-3d.js-9.3.1/highcharts-3d.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Dataviz Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Persistence in Mutual Fund Performance</h1>
                  <div>
        <div class="description">
          <p>In this article, I reproduce Figure 1 from Mark Carhart’s classic 1997 Journal of Finance article titled “On Persistence in Mutual Fund Performance”. The visualizations are created using highcharter and echarts4r packages. It is an interactive bar plot that shows that there is a very low persistence in the mutual fund performance.</p>
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://business.utsa.edu/faculty/profiles/malshe-ashwin.html">Ashwin Malshe</a> </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 30, 2020</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<p>Mark Carhart’s classic 1997 Journal of Finance paper is highly cited for the momentum factor used in asset pricing models. Carhart <span class="citation" data-cites="carhart1997persistence">(<a href="#ref-carhart1997persistence" role="doc-biblioref">1997</a>)</span> augmented Fama-French 3-factor model <span class="citation" data-cites="fama1993common">(<a href="#ref-fama1993common" role="doc-biblioref">Fama and French 1993</a>)</span> with a factor that accounts for the momentum anomaly identified by Jegadeesh and Titman <span class="citation" data-cites="jegadeesh1993returns">(<a href="#ref-jegadeesh1993returns" role="doc-biblioref">1993</a>)</span>.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Download Carhart’s article <a href="https://onlinelibrary.wiley.com/doi/pdf/10.1111/j.1540-6261.1997.tb03808.x">here</a>.</p>
</div></div><p>I read this article for the first time in spring 2007 while taking a class on Capital Markets Research at SUNY-Binghamton taught by <a href="https://poole.ncsu.edu/people/skrish16/">Srini Krishnamurthy</a>. Although this article is heavily cited for introducing the momentum factor, the topic of the article is way more interesting. In a nutshell, the article shows that mutual fund managers may not be as skilled as commonly believed, and their performance can be explained away mostly by momentum trading strategies. Furthermore, there is no persistence in mutual fund performance. This means that if you decide to invest in a fund based on the last year’s returns, the chances are slim that the performance of the fund will persist in future!</p>
<p>Although over the years I may have forgotten some of the details, Figure 1 from this paper is etched in my memory. From a purely data visualization perspective, it is a terrible plot. A 3-dimensional plot on 2-dimensional paper is no go. This is a static plot which means it lacks interactivity. Finally, this plot was printed in black and white! Yet, this is an amazing plot. I reproduce it here and explain why this is so insightful.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="../../Images/fig-1-carhart.png" class="img-fluid figure-img" width="785"></p>
</figure>
</div>
</div>
</div>
<p>This plot is based on one-year gross returns of mutual fund. Carhart first ranked these funds in a <em>descending order</em> of the annual returns and then created 10 deciles. Accodingly, Decile 1 contains top 10% funds by returns and Decile 10 has the poorest performing 10% funds. Next he tracks these funds in the succeeding year, where he again sorts them in one-year returns deciles. The plot above shows the transition probability of a fund ranked in decile <span class="math inline">\(i\)</span> in year <span class="math inline">\(t\)</span> moving to decile <span class="math inline">\(j\)</span> in year <span class="math inline">\(t+1\)</span>. Formally, he is plotting the following conditional probability: <span class="math inline">\(P(j|i)\)</span>. As some of these funds may not survive the next year, <span class="math inline">\(j \in [Decile 1,..., Decile 10, Dead]\)</span>.</p>
<p>If mutual funds managers are skilled and their performance is consistent, one would expect that <span class="math inline">\(P(j|i) ~ 1\)</span> when <span class="math inline">\(j = i\)</span>. However, the plot above implies something like <span class="math inline">\(P(j|i) ~ U(0, 1)\)</span> meaning a mutual fund may transition freely from one decile in a year to any decile the next year! That’s quite insightful.</p>
<section id="improving-figure-1" class="level2">
<h2 class="anchored" data-anchor-id="improving-figure-1">Improving Figure 1</h2>
<p>My objective of writing this post is to recreate this data visualization so that the insights are more apparent. In order to do that, I am creating four plots as follows:</p>
<ol type="1">
<li><p>The first plot is a 2-dimensional heatmap. This is a better representation because it will map the transition probabilities to colors rather than the height of the bars.</p></li>
<li><p>The second plot uses <code>echarts</code>, a D3 library in JavaScript. I am using an R wrapper called <code>echarts4r</code>. This plot will make this an interactive 3-dimensional visualization.</p></li>
<li><p>I recreate the 3-dimensinoal bar plot using another D3 library called <code>highcharts</code>. I am using an R wrapper called <code>highcharter</code>. With this, I could add different colors to the bars but at the same time, I lost the ability to rotate the plot. I correct it in the last plot.</p></li>
<li><p>In this plot, I use a Shiny app that adds rotation to the plot made using <code>highcharter</code>.</p></li>
</ol>
<div style="background-color: #d8dee9 ; padding: 10px; border: 1px black;">
<p>I used a mutual funds data set spanning 1961 to 2019. In my plots, the deciles are reversed. I created the deciles by sorting returns in <i>ascending order</i>. So Decile 1 consists of poorly performing mutual funds while Decile 10 consists of top performing mutual funds. Additionally, in my data I did not have a quick way to determine dead mutual funds so I don’t have that category. I just used the reported raw returns without adjusting them for the management expenses.</p>
</div>
</section>
<section id="heatmap" class="level2">
<h2 class="anchored" data-anchor-id="heatmap">Heatmap</h2>
<p>The first plot we will create is a heatmap.</p>
<div class="cell">
<div class="cell-output-display">
<div class="highchart html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ebec512f380ccf146b52" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ebec512f380ccf146b52">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":null},"yAxis":{"title":{"text":"Rank in Year t+1"},"type":"category","categories":["Decile 1","Decile 2","Decile 3","Decile 4","Decile 5","Decile 6","Decile 7","Decile 8","Decile 9","Decile 10"]},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":false},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"colorAxis":{"auxpar":null},"series":[{"group":"group","data":[{"rev_rank":1,"ld_rev_rank":1,"n":11387,"prob":0.22,"Rank in Year t":"Decile 1","Rank in Year t+1":"Decile 1","x":0,"y":0,"value":0.22,"color":"#440154","xf":"Decile 1","yf":"Decile 1","colorv":4.545454545454546},{"rev_rank":1,"ld_rev_rank":2,"n":4667,"prob":0.09,"Rank in Year t":"Decile 1","Rank in Year t+1":"Decile 2","x":0,"y":1,"value":0.09,"color":"#6AAD69","xf":"Decile 1","yf":"Decile 2","colorv":11.11111111111111},{"rev_rank":1,"ld_rev_rank":3,"n":4843,"prob":0.1,"Rank in Year t":"Decile 1","Rank in Year t+1":"Decile 3","x":0,"y":2,"value":0.1,"color":"#2F9585","xf":"Decile 1","yf":"Decile 3","colorv":10},{"rev_rank":1,"ld_rev_rank":4,"n":3042,"prob":0.06,"Rank in Year t":"Decile 1","Rank in Year t+1":"Decile 4","x":0,"y":3,"value":0.06,"color":"#FDE725","xf":"Decile 1","yf":"Decile 4","colorv":16.66666666666667},{"rev_rank":1,"ld_rev_rank":5,"n":2761,"prob":0.05,"Rank in Year t":"Decile 1","Rank in Year t+1":"Decile 5","x":0,"y":4,"value":0.05,"color":"#FDE725","xf":"Decile 1","yf":"Decile 5","colorv":20},{"rev_rank":1,"ld_rev_rank":6,"n":4197,"prob":0.08,"Rank in Year t":"Decile 1","Rank in Year t+1":"Decile 6","x":0,"y":5,"value":0.08,"color":"#A5C44E","xf":"Decile 1","yf":"Decile 6","colorv":12.5},{"rev_rank":1,"ld_rev_rank":7,"n":2655,"prob":0.05,"Rank in Year t":"Decile 1","Rank in Year t+1":"Decile 7","x":0,"y":6,"value":0.05,"color":"#FDE725","xf":"Decile 1","yf":"Decile 7","colorv":20},{"rev_rank":1,"ld_rev_rank":8,"n":3625,"prob":0.07000000000000001,"Rank in Year t":"Decile 1","Rank in Year t+1":"Decile 8","x":0,"y":7,"value":0.07000000000000001,"color":"#C2CF40","xf":"Decile 1","yf":"Decile 8","colorv":14.28571428571428},{"rev_rank":1,"ld_rev_rank":9,"n":4940,"prob":0.1,"Rank in Year t":"Decile 1","Rank in Year t+1":"Decile 9","x":0,"y":8,"value":0.1,"color":"#2F9585","xf":"Decile 1","yf":"Decile 9","colorv":10},{"rev_rank":1,"ld_rev_rank":10,"n":8493,"prob":0.17,"Rank in Year t":"Decile 1","Rank in Year t+1":"Decile 10","x":0,"y":9,"value":0.17,"color":"#440154","xf":"Decile 1","yf":"Decile 10","colorv":5.88235294117647},{"rev_rank":2,"ld_rev_rank":1,"n":5500,"prob":0.11,"Rank in Year t":"Decile 2","Rank in Year t+1":"Decile 1","x":1,"y":0,"value":0.11,"color":"#2C6079","xf":"Decile 2","yf":"Decile 1","colorv":9.090909090909092},{"rev_rank":2,"ld_rev_rank":2,"n":7875,"prob":0.15,"Rank in Year t":"Decile 2","Rank in Year t+1":"Decile 2","x":1,"y":1,"value":0.15,"color":"#3F145B","xf":"Decile 2","yf":"Decile 2","colorv":6.666666666666667},{"rev_rank":2,"ld_rev_rank":3,"n":5826,"prob":0.11,"Rank in Year t":"Decile 2","Rank in Year t+1":"Decile 3","x":1,"y":2,"value":0.11,"color":"#2C6079","xf":"Decile 2","yf":"Decile 3","colorv":9.090909090909092},{"rev_rank":2,"ld_rev_rank":4,"n":4484,"prob":0.09,"Rank in Year t":"Decile 2","Rank in Year t+1":"Decile 4","x":1,"y":3,"value":0.09,"color":"#6AAD69","xf":"Decile 2","yf":"Decile 4","colorv":11.11111111111111},{"rev_rank":2,"ld_rev_rank":5,"n":4228,"prob":0.08,"Rank in Year t":"Decile 2","Rank in Year t+1":"Decile 5","x":1,"y":4,"value":0.08,"color":"#A5C44E","xf":"Decile 2","yf":"Decile 5","colorv":12.5},{"rev_rank":2,"ld_rev_rank":6,"n":4148,"prob":0.08,"Rank in Year t":"Decile 2","Rank in Year t+1":"Decile 6","x":1,"y":5,"value":0.08,"color":"#A5C44E","xf":"Decile 2","yf":"Decile 6","colorv":12.5},{"rev_rank":2,"ld_rev_rank":7,"n":4344,"prob":0.08,"Rank in Year t":"Decile 2","Rank in Year t+1":"Decile 7","x":1,"y":6,"value":0.08,"color":"#A5C44E","xf":"Decile 2","yf":"Decile 7","colorv":12.5},{"rev_rank":2,"ld_rev_rank":8,"n":4671,"prob":0.09,"Rank in Year t":"Decile 2","Rank in Year t+1":"Decile 8","x":1,"y":7,"value":0.09,"color":"#6AAD69","xf":"Decile 2","yf":"Decile 8","colorv":11.11111111111111},{"rev_rank":2,"ld_rev_rank":9,"n":5381,"prob":0.11,"Rank in Year t":"Decile 2","Rank in Year t+1":"Decile 9","x":1,"y":8,"value":0.11,"color":"#2C6079","xf":"Decile 2","yf":"Decile 9","colorv":9.090909090909092},{"rev_rank":2,"ld_rev_rank":10,"n":4745,"prob":0.09,"Rank in Year t":"Decile 2","Rank in Year t+1":"Decile 10","x":1,"y":9,"value":0.09,"color":"#6AAD69","xf":"Decile 2","yf":"Decile 10","colorv":11.11111111111111},{"rev_rank":3,"ld_rev_rank":1,"n":3671,"prob":0.07000000000000001,"Rank in Year t":"Decile 3","Rank in Year t+1":"Decile 1","x":2,"y":0,"value":0.07000000000000001,"color":"#C2CF40","xf":"Decile 3","yf":"Decile 1","colorv":14.28571428571428},{"rev_rank":3,"ld_rev_rank":2,"n":6542,"prob":0.13,"Rank in Year t":"Decile 3","Rank in Year t+1":"Decile 2","x":2,"y":1,"value":0.13,"color":"#363A6A","xf":"Decile 3","yf":"Decile 2","colorv":7.692307692307692},{"rev_rank":3,"ld_rev_rank":3,"n":6862,"prob":0.13,"Rank in Year t":"Decile 3","Rank in Year t+1":"Decile 3","x":2,"y":2,"value":0.13,"color":"#363A6A","xf":"Decile 3","yf":"Decile 3","colorv":7.692307692307692},{"rev_rank":3,"ld_rev_rank":4,"n":6116,"prob":0.12,"Rank in Year t":"Decile 3","Rank in Year t+1":"Decile 4","x":2,"y":3,"value":0.12,"color":"#314D71","xf":"Decile 3","yf":"Decile 4","colorv":8.333333333333334},{"rev_rank":3,"ld_rev_rank":5,"n":4713,"prob":0.09,"Rank in Year t":"Decile 3","Rank in Year t+1":"Decile 5","x":2,"y":4,"value":0.09,"color":"#6AAD69","xf":"Decile 3","yf":"Decile 5","colorv":11.11111111111111},{"rev_rank":3,"ld_rev_rank":6,"n":4064,"prob":0.08,"Rank in Year t":"Decile 3","Rank in Year t+1":"Decile 6","x":2,"y":5,"value":0.08,"color":"#A5C44E","xf":"Decile 3","yf":"Decile 6","colorv":12.5},{"rev_rank":3,"ld_rev_rank":7,"n":5740,"prob":0.11,"Rank in Year t":"Decile 3","Rank in Year t+1":"Decile 7","x":2,"y":6,"value":0.11,"color":"#2C6079","xf":"Decile 3","yf":"Decile 7","colorv":9.090909090909092},{"rev_rank":3,"ld_rev_rank":8,"n":5413,"prob":0.1,"Rank in Year t":"Decile 3","Rank in Year t+1":"Decile 8","x":2,"y":7,"value":0.1,"color":"#2F9585","xf":"Decile 3","yf":"Decile 8","colorv":10},{"rev_rank":3,"ld_rev_rank":9,"n":5216,"prob":0.1,"Rank in Year t":"Decile 3","Rank in Year t+1":"Decile 9","x":2,"y":8,"value":0.1,"color":"#2F9585","xf":"Decile 3","yf":"Decile 9","colorv":10},{"rev_rank":3,"ld_rev_rank":10,"n":3490,"prob":0.07000000000000001,"Rank in Year t":"Decile 3","Rank in Year t+1":"Decile 10","x":2,"y":9,"value":0.07000000000000001,"color":"#C2CF40","xf":"Decile 3","yf":"Decile 10","colorv":14.28571428571428},{"rev_rank":4,"ld_rev_rank":1,"n":2749,"prob":0.05,"Rank in Year t":"Decile 4","Rank in Year t+1":"Decile 1","x":3,"y":0,"value":0.05,"color":"#FDE725","xf":"Decile 4","yf":"Decile 1","colorv":20},{"rev_rank":4,"ld_rev_rank":2,"n":4044,"prob":0.08,"Rank in Year t":"Decile 4","Rank in Year t+1":"Decile 2","x":3,"y":1,"value":0.08,"color":"#A5C44E","xf":"Decile 4","yf":"Decile 2","colorv":12.5},{"rev_rank":4,"ld_rev_rank":3,"n":5574,"prob":0.11,"Rank in Year t":"Decile 4","Rank in Year t+1":"Decile 3","x":3,"y":2,"value":0.11,"color":"#2C6079","xf":"Decile 4","yf":"Decile 3","colorv":9.090909090909092},{"rev_rank":4,"ld_rev_rank":4,"n":7060,"prob":0.14,"Rank in Year t":"Decile 4","Rank in Year t+1":"Decile 4","x":3,"y":3,"value":0.14,"color":"#3A2762","xf":"Decile 4","yf":"Decile 4","colorv":7.142857142857142},{"rev_rank":4,"ld_rev_rank":5,"n":8023,"prob":0.15,"Rank in Year t":"Decile 4","Rank in Year t+1":"Decile 5","x":3,"y":4,"value":0.15,"color":"#3F145B","xf":"Decile 4","yf":"Decile 5","colorv":6.666666666666667},{"rev_rank":4,"ld_rev_rank":6,"n":6004,"prob":0.12,"Rank in Year t":"Decile 4","Rank in Year t+1":"Decile 6","x":3,"y":5,"value":0.12,"color":"#314D71","xf":"Decile 4","yf":"Decile 6","colorv":8.333333333333334},{"rev_rank":4,"ld_rev_rank":7,"n":5736,"prob":0.11,"Rank in Year t":"Decile 4","Rank in Year t+1":"Decile 7","x":3,"y":6,"value":0.11,"color":"#2C6079","xf":"Decile 4","yf":"Decile 7","colorv":9.090909090909092},{"rev_rank":4,"ld_rev_rank":8,"n":5027,"prob":0.1,"Rank in Year t":"Decile 4","Rank in Year t+1":"Decile 8","x":3,"y":7,"value":0.1,"color":"#2F9585","xf":"Decile 4","yf":"Decile 8","colorv":10},{"rev_rank":4,"ld_rev_rank":9,"n":4396,"prob":0.08,"Rank in Year t":"Decile 4","Rank in Year t+1":"Decile 9","x":3,"y":8,"value":0.08,"color":"#A5C44E","xf":"Decile 4","yf":"Decile 9","colorv":12.5},{"rev_rank":4,"ld_rev_rank":10,"n":3334,"prob":0.06,"Rank in Year t":"Decile 4","Rank in Year t+1":"Decile 10","x":3,"y":9,"value":0.06,"color":"#FDE725","xf":"Decile 4","yf":"Decile 10","colorv":16.66666666666667},{"rev_rank":5,"ld_rev_rank":1,"n":2619,"prob":0.05,"Rank in Year t":"Decile 5","Rank in Year t+1":"Decile 1","x":4,"y":0,"value":0.05,"color":"#FDE725","xf":"Decile 5","yf":"Decile 1","colorv":20},{"rev_rank":5,"ld_rev_rank":2,"n":3340,"prob":0.06,"Rank in Year t":"Decile 5","Rank in Year t+1":"Decile 2","x":4,"y":1,"value":0.06,"color":"#FDE725","xf":"Decile 5","yf":"Decile 2","colorv":16.66666666666667},{"rev_rank":5,"ld_rev_rank":3,"n":4445,"prob":0.09,"Rank in Year t":"Decile 5","Rank in Year t+1":"Decile 3","x":4,"y":2,"value":0.09,"color":"#6AAD69","xf":"Decile 5","yf":"Decile 3","colorv":11.11111111111111},{"rev_rank":5,"ld_rev_rank":4,"n":6271,"prob":0.12,"Rank in Year t":"Decile 5","Rank in Year t+1":"Decile 4","x":4,"y":3,"value":0.12,"color":"#314D71","xf":"Decile 5","yf":"Decile 4","colorv":8.333333333333334},{"rev_rank":5,"ld_rev_rank":5,"n":8337,"prob":0.16,"Rank in Year t":"Decile 5","Rank in Year t+1":"Decile 5","x":4,"y":4,"value":0.16,"color":"#440154","xf":"Decile 5","yf":"Decile 5","colorv":6.25},{"rev_rank":5,"ld_rev_rank":6,"n":9256,"prob":0.18,"Rank in Year t":"Decile 5","Rank in Year t+1":"Decile 6","x":4,"y":5,"value":0.18,"color":"#440154","xf":"Decile 5","yf":"Decile 6","colorv":5.555555555555555},{"rev_rank":5,"ld_rev_rank":7,"n":6097,"prob":0.12,"Rank in Year t":"Decile 5","Rank in Year t+1":"Decile 7","x":4,"y":6,"value":0.12,"color":"#314D71","xf":"Decile 5","yf":"Decile 7","colorv":8.333333333333334},{"rev_rank":5,"ld_rev_rank":8,"n":4585,"prob":0.09,"Rank in Year t":"Decile 5","Rank in Year t+1":"Decile 8","x":4,"y":7,"value":0.09,"color":"#6AAD69","xf":"Decile 5","yf":"Decile 8","colorv":11.11111111111111},{"rev_rank":5,"ld_rev_rank":9,"n":4112,"prob":0.08,"Rank in Year t":"Decile 5","Rank in Year t+1":"Decile 9","x":4,"y":8,"value":0.08,"color":"#A5C44E","xf":"Decile 5","yf":"Decile 9","colorv":12.5},{"rev_rank":5,"ld_rev_rank":10,"n":3122,"prob":0.06,"Rank in Year t":"Decile 5","Rank in Year t+1":"Decile 10","x":4,"y":9,"value":0.06,"color":"#FDE725","xf":"Decile 5","yf":"Decile 10","colorv":16.66666666666667},{"rev_rank":6,"ld_rev_rank":1,"n":3955,"prob":0.08,"Rank in Year t":"Decile 6","Rank in Year t+1":"Decile 1","x":5,"y":0,"value":0.08,"color":"#A5C44E","xf":"Decile 6","yf":"Decile 1","colorv":12.5},{"rev_rank":6,"ld_rev_rank":2,"n":2926,"prob":0.06,"Rank in Year t":"Decile 6","Rank in Year t+1":"Decile 2","x":5,"y":1,"value":0.06,"color":"#FDE725","xf":"Decile 6","yf":"Decile 2","colorv":16.66666666666667},{"rev_rank":6,"ld_rev_rank":3,"n":4214,"prob":0.08,"Rank in Year t":"Decile 6","Rank in Year t+1":"Decile 3","x":5,"y":2,"value":0.08,"color":"#A5C44E","xf":"Decile 6","yf":"Decile 3","colorv":12.5},{"rev_rank":6,"ld_rev_rank":4,"n":5881,"prob":0.11,"Rank in Year t":"Decile 6","Rank in Year t+1":"Decile 4","x":5,"y":3,"value":0.11,"color":"#2C6079","xf":"Decile 6","yf":"Decile 4","colorv":9.090909090909092},{"rev_rank":6,"ld_rev_rank":5,"n":7574,"prob":0.14,"Rank in Year t":"Decile 6","Rank in Year t+1":"Decile 5","x":5,"y":4,"value":0.14,"color":"#3A2762","xf":"Decile 6","yf":"Decile 5","colorv":7.142857142857142},{"rev_rank":6,"ld_rev_rank":6,"n":7396,"prob":0.14,"Rank in Year t":"Decile 6","Rank in Year t+1":"Decile 6","x":5,"y":5,"value":0.14,"color":"#3A2762","xf":"Decile 6","yf":"Decile 6","colorv":7.142857142857142},{"rev_rank":6,"ld_rev_rank":7,"n":7238,"prob":0.14,"Rank in Year t":"Decile 6","Rank in Year t+1":"Decile 7","x":5,"y":6,"value":0.14,"color":"#3A2762","xf":"Decile 6","yf":"Decile 7","colorv":7.142857142857142},{"rev_rank":6,"ld_rev_rank":8,"n":5433,"prob":0.1,"Rank in Year t":"Decile 6","Rank in Year t+1":"Decile 8","x":5,"y":7,"value":0.1,"color":"#2F9585","xf":"Decile 6","yf":"Decile 8","colorv":10},{"rev_rank":6,"ld_rev_rank":9,"n":4476,"prob":0.09,"Rank in Year t":"Decile 6","Rank in Year t+1":"Decile 9","x":5,"y":8,"value":0.09,"color":"#6AAD69","xf":"Decile 6","yf":"Decile 9","colorv":11.11111111111111},{"rev_rank":6,"ld_rev_rank":10,"n":3302,"prob":0.06,"Rank in Year t":"Decile 6","Rank in Year t+1":"Decile 10","x":5,"y":9,"value":0.06,"color":"#FDE725","xf":"Decile 6","yf":"Decile 10","colorv":16.66666666666667},{"rev_rank":7,"ld_rev_rank":1,"n":3955,"prob":0.08,"Rank in Year t":"Decile 7","Rank in Year t+1":"Decile 1","x":6,"y":0,"value":0.08,"color":"#A5C44E","xf":"Decile 7","yf":"Decile 1","colorv":12.5},{"rev_rank":7,"ld_rev_rank":2,"n":4496,"prob":0.09,"Rank in Year t":"Decile 7","Rank in Year t+1":"Decile 2","x":6,"y":1,"value":0.09,"color":"#6AAD69","xf":"Decile 7","yf":"Decile 2","colorv":11.11111111111111},{"rev_rank":7,"ld_rev_rank":3,"n":4449,"prob":0.08,"Rank in Year t":"Decile 7","Rank in Year t+1":"Decile 3","x":6,"y":2,"value":0.08,"color":"#A5C44E","xf":"Decile 7","yf":"Decile 3","colorv":12.5},{"rev_rank":7,"ld_rev_rank":4,"n":6474,"prob":0.12,"Rank in Year t":"Decile 7","Rank in Year t+1":"Decile 4","x":6,"y":3,"value":0.12,"color":"#314D71","xf":"Decile 7","yf":"Decile 4","colorv":8.333333333333334},{"rev_rank":7,"ld_rev_rank":5,"n":5592,"prob":0.11,"Rank in Year t":"Decile 7","Rank in Year t+1":"Decile 5","x":6,"y":4,"value":0.11,"color":"#2C6079","xf":"Decile 7","yf":"Decile 5","colorv":9.090909090909092},{"rev_rank":7,"ld_rev_rank":6,"n":5620,"prob":0.11,"Rank in Year t":"Decile 7","Rank in Year t+1":"Decile 6","x":6,"y":5,"value":0.11,"color":"#2C6079","xf":"Decile 7","yf":"Decile 6","colorv":9.090909090909092},{"rev_rank":7,"ld_rev_rank":7,"n":6657,"prob":0.13,"Rank in Year t":"Decile 7","Rank in Year t+1":"Decile 7","x":6,"y":6,"value":0.13,"color":"#363A6A","xf":"Decile 7","yf":"Decile 7","colorv":7.692307692307692},{"rev_rank":7,"ld_rev_rank":8,"n":6263,"prob":0.12,"Rank in Year t":"Decile 7","Rank in Year t+1":"Decile 8","x":6,"y":7,"value":0.12,"color":"#314D71","xf":"Decile 7","yf":"Decile 8","colorv":8.333333333333334},{"rev_rank":7,"ld_rev_rank":9,"n":5110,"prob":0.1,"Rank in Year t":"Decile 7","Rank in Year t+1":"Decile 9","x":6,"y":8,"value":0.1,"color":"#2F9585","xf":"Decile 7","yf":"Decile 9","colorv":10},{"rev_rank":7,"ld_rev_rank":10,"n":3831,"prob":0.07000000000000001,"Rank in Year t":"Decile 7","Rank in Year t+1":"Decile 10","x":6,"y":9,"value":0.07000000000000001,"color":"#C2CF40","xf":"Decile 7","yf":"Decile 10","colorv":14.28571428571428},{"rev_rank":8,"ld_rev_rank":1,"n":3483,"prob":0.07000000000000001,"Rank in Year t":"Decile 8","Rank in Year t+1":"Decile 1","x":7,"y":0,"value":0.07000000000000001,"color":"#C2CF40","xf":"Decile 8","yf":"Decile 1","colorv":14.28571428571428},{"rev_rank":8,"ld_rev_rank":2,"n":5096,"prob":0.1,"Rank in Year t":"Decile 8","Rank in Year t+1":"Decile 2","x":7,"y":1,"value":0.1,"color":"#2F9585","xf":"Decile 8","yf":"Decile 2","colorv":10},{"rev_rank":8,"ld_rev_rank":3,"n":6516,"prob":0.12,"Rank in Year t":"Decile 8","Rank in Year t+1":"Decile 3","x":7,"y":2,"value":0.12,"color":"#314D71","xf":"Decile 8","yf":"Decile 3","colorv":8.333333333333334},{"rev_rank":8,"ld_rev_rank":4,"n":5033,"prob":0.1,"Rank in Year t":"Decile 8","Rank in Year t+1":"Decile 4","x":7,"y":3,"value":0.1,"color":"#2F9585","xf":"Decile 8","yf":"Decile 4","colorv":10},{"rev_rank":8,"ld_rev_rank":5,"n":4043,"prob":0.08,"Rank in Year t":"Decile 8","Rank in Year t+1":"Decile 5","x":7,"y":4,"value":0.08,"color":"#A5C44E","xf":"Decile 8","yf":"Decile 5","colorv":12.5},{"rev_rank":8,"ld_rev_rank":6,"n":4466,"prob":0.08,"Rank in Year t":"Decile 8","Rank in Year t+1":"Decile 6","x":7,"y":5,"value":0.08,"color":"#A5C44E","xf":"Decile 8","yf":"Decile 6","colorv":12.5},{"rev_rank":8,"ld_rev_rank":7,"n":5439,"prob":0.1,"Rank in Year t":"Decile 8","Rank in Year t+1":"Decile 7","x":7,"y":6,"value":0.1,"color":"#2F9585","xf":"Decile 8","yf":"Decile 7","colorv":10},{"rev_rank":8,"ld_rev_rank":8,"n":6903,"prob":0.13,"Rank in Year t":"Decile 8","Rank in Year t+1":"Decile 8","x":7,"y":7,"value":0.13,"color":"#363A6A","xf":"Decile 8","yf":"Decile 8","colorv":7.692307692307692},{"rev_rank":8,"ld_rev_rank":9,"n":6650,"prob":0.13,"Rank in Year t":"Decile 8","Rank in Year t+1":"Decile 9","x":7,"y":8,"value":0.13,"color":"#363A6A","xf":"Decile 8","yf":"Decile 9","colorv":7.692307692307692},{"rev_rank":8,"ld_rev_rank":10,"n":5216,"prob":0.1,"Rank in Year t":"Decile 8","Rank in Year t+1":"Decile 10","x":7,"y":9,"value":0.1,"color":"#2F9585","xf":"Decile 8","yf":"Decile 10","colorv":10},{"rev_rank":9,"ld_rev_rank":1,"n":5222,"prob":0.1,"Rank in Year t":"Decile 9","Rank in Year t+1":"Decile 1","x":8,"y":0,"value":0.1,"color":"#2F9585","xf":"Decile 9","yf":"Decile 1","colorv":10},{"rev_rank":9,"ld_rev_rank":2,"n":8057,"prob":0.15,"Rank in Year t":"Decile 9","Rank in Year t+1":"Decile 2","x":8,"y":1,"value":0.15,"color":"#3F145B","xf":"Decile 9","yf":"Decile 2","colorv":6.666666666666667},{"rev_rank":9,"ld_rev_rank":3,"n":5435,"prob":0.1,"Rank in Year t":"Decile 9","Rank in Year t+1":"Decile 3","x":8,"y":2,"value":0.1,"color":"#2F9585","xf":"Decile 9","yf":"Decile 3","colorv":10},{"rev_rank":9,"ld_rev_rank":4,"n":3889,"prob":0.07000000000000001,"Rank in Year t":"Decile 9","Rank in Year t+1":"Decile 4","x":8,"y":3,"value":0.07000000000000001,"color":"#C2CF40","xf":"Decile 9","yf":"Decile 4","colorv":14.28571428571428},{"rev_rank":9,"ld_rev_rank":5,"n":3367,"prob":0.06,"Rank in Year t":"Decile 9","Rank in Year t+1":"Decile 5","x":8,"y":4,"value":0.06,"color":"#FDE725","xf":"Decile 9","yf":"Decile 5","colorv":16.66666666666667},{"rev_rank":9,"ld_rev_rank":6,"n":3565,"prob":0.07000000000000001,"Rank in Year t":"Decile 9","Rank in Year t+1":"Decile 6","x":8,"y":5,"value":0.07000000000000001,"color":"#C2CF40","xf":"Decile 9","yf":"Decile 6","colorv":14.28571428571428},{"rev_rank":9,"ld_rev_rank":7,"n":4465,"prob":0.08,"Rank in Year t":"Decile 9","Rank in Year t+1":"Decile 7","x":8,"y":6,"value":0.08,"color":"#A5C44E","xf":"Decile 9","yf":"Decile 7","colorv":12.5},{"rev_rank":9,"ld_rev_rank":8,"n":5563,"prob":0.1,"Rank in Year t":"Decile 9","Rank in Year t+1":"Decile 8","x":8,"y":7,"value":0.1,"color":"#2F9585","xf":"Decile 9","yf":"Decile 8","colorv":10},{"rev_rank":9,"ld_rev_rank":9,"n":6891,"prob":0.13,"Rank in Year t":"Decile 9","Rank in Year t+1":"Decile 9","x":8,"y":8,"value":0.13,"color":"#363A6A","xf":"Decile 9","yf":"Decile 9","colorv":7.692307692307692},{"rev_rank":9,"ld_rev_rank":10,"n":6582,"prob":0.12,"Rank in Year t":"Decile 9","Rank in Year t+1":"Decile 10","x":8,"y":9,"value":0.12,"color":"#314D71","xf":"Decile 9","yf":"Decile 10","colorv":8.333333333333334},{"rev_rank":10,"ld_rev_rank":1,"n":9035,"prob":0.17,"Rank in Year t":"Decile 10","Rank in Year t+1":"Decile 1","x":9,"y":0,"value":0.17,"color":"#440154","xf":"Decile 10","yf":"Decile 1","colorv":5.88235294117647},{"rev_rank":10,"ld_rev_rank":2,"n":5475,"prob":0.1,"Rank in Year t":"Decile 10","Rank in Year t+1":"Decile 2","x":9,"y":1,"value":0.1,"color":"#2F9585","xf":"Decile 10","yf":"Decile 2","colorv":10},{"rev_rank":10,"ld_rev_rank":3,"n":4658,"prob":0.09,"Rank in Year t":"Decile 10","Rank in Year t+1":"Decile 3","x":9,"y":2,"value":0.09,"color":"#6AAD69","xf":"Decile 10","yf":"Decile 3","colorv":11.11111111111111},{"rev_rank":10,"ld_rev_rank":4,"n":3885,"prob":0.07000000000000001,"Rank in Year t":"Decile 10","Rank in Year t+1":"Decile 4","x":9,"y":3,"value":0.07000000000000001,"color":"#C2CF40","xf":"Decile 10","yf":"Decile 4","colorv":14.28571428571428},{"rev_rank":10,"ld_rev_rank":5,"n":3378,"prob":0.06,"Rank in Year t":"Decile 10","Rank in Year t+1":"Decile 5","x":9,"y":4,"value":0.06,"color":"#FDE725","xf":"Decile 10","yf":"Decile 5","colorv":16.66666666666667},{"rev_rank":10,"ld_rev_rank":6,"n":3332,"prob":0.06,"Rank in Year t":"Decile 10","Rank in Year t+1":"Decile 6","x":9,"y":5,"value":0.06,"color":"#FDE725","xf":"Decile 10","yf":"Decile 6","colorv":16.66666666666667},{"rev_rank":10,"ld_rev_rank":7,"n":3446,"prob":0.06,"Rank in Year t":"Decile 10","Rank in Year t+1":"Decile 7","x":9,"y":6,"value":0.06,"color":"#FDE725","xf":"Decile 10","yf":"Decile 7","colorv":16.66666666666667},{"rev_rank":10,"ld_rev_rank":8,"n":4786,"prob":0.09,"Rank in Year t":"Decile 10","Rank in Year t+1":"Decile 8","x":9,"y":7,"value":0.09,"color":"#6AAD69","xf":"Decile 10","yf":"Decile 8","colorv":11.11111111111111},{"rev_rank":10,"ld_rev_rank":9,"n":5570,"prob":0.1,"Rank in Year t":"Decile 10","Rank in Year t+1":"Decile 9","x":9,"y":8,"value":0.1,"color":"#2F9585","xf":"Decile 10","yf":"Decile 9","colorv":10},{"rev_rank":10,"ld_rev_rank":10,"n":9913,"prob":0.19,"Rank in Year t":"Decile 10","Rank in Year t+1":"Decile 10","x":9,"y":9,"value":0.19,"color":"#440154","xf":"Decile 10","yf":"Decile 10","colorv":5.263157894736842}],"type":"heatmap","opacity":0.8,"name":"Transition Probability"}],"xAxis":{"type":"category","title":{"text":"Rank in Year t"},"categories":["Decile 1","Decile 2","Decile 3","Decile 4","Decile 5","Decile 6","Decile 7","Decile 8","Decile 9","Decile 10"]},"tooltip":{"pointFormat":"Previous Decile: {point.x} <br> New Decile: {point.y} <br> Probability: {point.value}"},"legend":[]},"theme":{"colors":["#0266C8","#F90101","#F2B50F","#00933B"],"chart":{"style":{"fontFamily":"Roboto","color":"#444444"}},"xAxis":{"gridLineWidth":1,"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"yAxis":{"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"legendBackgroundColor":"rgba(0, 0, 0, 0.5)","background2":"#505053","dataLabelsColor":"#B0B0B3","textColor":"#C0C0C0","contrastTextColor":"#F0F0F3","maskColor":"rgba(255,255,255,0.3)"},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadCSV":"Download CSV","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","downloadXLS":"Download XLS","drillUpText":"◁ Back to {series.name}","exitFullscreen":"Exit from full screen","exportData":{"annotationHeader":"Annotations","categoryDatetimeHeader":"DateTime","categoryHeader":"Category"},"hideData":"Hide data table","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbolMagnitude":1000,"numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"shortWeekdays":["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],"thousandsSep":" ","viewData":"View data table","viewFullscreen":"View in full screen","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":"Roboto","debug":false},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>In this heatmap, things look a bit more interesting. We can see that the primary and secondary diagonal elements are darker than the off diagonal elements. Following the standard notations in linear algbra, the primary diagonal runs from top left to bottom right. The dark rectangles towards the ends of the diagonal suggest that there is a higher transition probability from low deciles to high deciles and vice versa. The secondary diagonal runs from bottom left to top right. This diagonal captures persistence in performance. The elements on this diagonal are darker suggesting some evidence of persistence. However, the highest probability is 22% for Decile 1. For Decile 9 and 10, these are 13% and 19% respectively. Thus, the evidence for persistence is weak at best. ALso note that although I extended the time period under investigation to 2019, the results are remarkably similar to what Carhart reported in 1997!</p>
</section>
<section id="dimensional-bar-plot-using-echarts4r" class="level2">
<h2 class="anchored" data-anchor-id="dimensional-bar-plot-using-echarts4r">3-Dimensional Bar Plot using <code>echarts4r</code></h2>
<p>I wanted to more closely replicate Carhart’s visualization. I decided to use <code>echarts4r</code> to recreate this plot because this package has an easy way to create 3-d plots. However, it has a few limitations as well. R package has only a few functionalities of the original <code>echarts</code> library. I am not proficient in JavaScript so I can’t make finer changes to the plot. Let’s give it a shot. Note that the X axis has the deciles in year t, Y axis has the deciles in year t+1, and the Z axis has the probabilities.</p>
<div class="cell">
<div class="cell-output-display">
<div class="echarts4r html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-5a0e1f81a63cae9b5436" style="width:100%;height:500px;"></div>
<script type="application/json" data-for="htmlwidget-5a0e1f81a63cae9b5436">{"x":{"theme":"blue","tl":false,"draw":true,"renderer":"canvas","events":[],"buttons":[],"opts":{"xAxis3D":[{"type":"category","data":["1","10","2","3","4","5","6","7","8","9"]}],"yAxis3D":[{"type":"category","data":["1","2","3","4","5","6","7","8","9","10"]}],"zAxis3D":[{"type":"value"}],"grid3D":[{"show":true}],"legend":{"data":["Probability of Switching","Probability of Switching","Probability of Switching","Probability of Switching","Probability of Switching","Probability of Switching","Probability of Switching","Probability of Switching","Probability of Switching","Probability of Switching"],"show":false,"type":"plain"},"series":[{"name":"Probability of Switching","type":"bar3D","coordinateSystem":"cartesian3D","data":[{"value":["1","1","0.22"]},{"value":["1","2","0.09"]},{"value":["1","3","0.10"]},{"value":["1","4","0.06"]},{"value":["1","5","0.05"]},{"value":["1","6","0.08"]},{"value":["1","7","0.05"]},{"value":["1","8","0.07"]},{"value":["1","9","0.10"]},{"value":["1","10","0.17"]}],"itemStyle":{"opacity":0.4},"emphasis":{"itemStyle":{"color":"#313695","opacity":1}}},{"name":"Probability of Switching","type":"bar3D","coordinateSystem":"cartesian3D","data":[{"value":["10","1","0.17"]},{"value":["10","2","0.10"]},{"value":["10","3","0.09"]},{"value":["10","4","0.07"]},{"value":["10","5","0.06"]},{"value":["10","6","0.06"]},{"value":["10","7","0.06"]},{"value":["10","8","0.09"]},{"value":["10","9","0.10"]},{"value":["10","10","0.19"]}],"itemStyle":{"opacity":0.4},"emphasis":{"itemStyle":{"color":"#313695","opacity":1}}},{"name":"Probability of Switching","type":"bar3D","coordinateSystem":"cartesian3D","data":[{"value":["2","1","0.11"]},{"value":["2","2","0.15"]},{"value":["2","3","0.11"]},{"value":["2","4","0.09"]},{"value":["2","5","0.08"]},{"value":["2","6","0.08"]},{"value":["2","7","0.08"]},{"value":["2","8","0.09"]},{"value":["2","9","0.11"]},{"value":["2","10","0.09"]}],"itemStyle":{"opacity":0.4},"emphasis":{"itemStyle":{"color":"#313695","opacity":1}}},{"name":"Probability of Switching","type":"bar3D","coordinateSystem":"cartesian3D","data":[{"value":["3","1","0.07"]},{"value":["3","2","0.13"]},{"value":["3","3","0.13"]},{"value":["3","4","0.12"]},{"value":["3","5","0.09"]},{"value":["3","6","0.08"]},{"value":["3","7","0.11"]},{"value":["3","8","0.10"]},{"value":["3","9","0.10"]},{"value":["3","10","0.07"]}],"itemStyle":{"opacity":0.4},"emphasis":{"itemStyle":{"color":"#313695","opacity":1}}},{"name":"Probability of Switching","type":"bar3D","coordinateSystem":"cartesian3D","data":[{"value":["4","1","0.05"]},{"value":["4","2","0.08"]},{"value":["4","3","0.11"]},{"value":["4","4","0.14"]},{"value":["4","5","0.15"]},{"value":["4","6","0.12"]},{"value":["4","7","0.11"]},{"value":["4","8","0.10"]},{"value":["4","9","0.08"]},{"value":["4","10","0.06"]}],"itemStyle":{"opacity":0.4},"emphasis":{"itemStyle":{"color":"#313695","opacity":1}}},{"name":"Probability of Switching","type":"bar3D","coordinateSystem":"cartesian3D","data":[{"value":["5","1","0.05"]},{"value":["5","2","0.06"]},{"value":["5","3","0.09"]},{"value":["5","4","0.12"]},{"value":["5","5","0.16"]},{"value":["5","6","0.18"]},{"value":["5","7","0.12"]},{"value":["5","8","0.09"]},{"value":["5","9","0.08"]},{"value":["5","10","0.06"]}],"itemStyle":{"opacity":0.4},"emphasis":{"itemStyle":{"color":"#313695","opacity":1}}},{"name":"Probability of Switching","type":"bar3D","coordinateSystem":"cartesian3D","data":[{"value":["6","1","0.08"]},{"value":["6","2","0.06"]},{"value":["6","3","0.08"]},{"value":["6","4","0.11"]},{"value":["6","5","0.14"]},{"value":["6","6","0.14"]},{"value":["6","7","0.14"]},{"value":["6","8","0.10"]},{"value":["6","9","0.09"]},{"value":["6","10","0.06"]}],"itemStyle":{"opacity":0.4},"emphasis":{"itemStyle":{"color":"#313695","opacity":1}}},{"name":"Probability of Switching","type":"bar3D","coordinateSystem":"cartesian3D","data":[{"value":["7","1","0.08"]},{"value":["7","2","0.09"]},{"value":["7","3","0.08"]},{"value":["7","4","0.12"]},{"value":["7","5","0.11"]},{"value":["7","6","0.11"]},{"value":["7","7","0.13"]},{"value":["7","8","0.12"]},{"value":["7","9","0.10"]},{"value":["7","10","0.07"]}],"itemStyle":{"opacity":0.4},"emphasis":{"itemStyle":{"color":"#313695","opacity":1}}},{"name":"Probability of Switching","type":"bar3D","coordinateSystem":"cartesian3D","data":[{"value":["8","1","0.07"]},{"value":["8","2","0.10"]},{"value":["8","3","0.12"]},{"value":["8","4","0.10"]},{"value":["8","5","0.08"]},{"value":["8","6","0.08"]},{"value":["8","7","0.10"]},{"value":["8","8","0.13"]},{"value":["8","9","0.13"]},{"value":["8","10","0.10"]}],"itemStyle":{"opacity":0.4},"emphasis":{"itemStyle":{"color":"#313695","opacity":1}}},{"name":"Probability of Switching","type":"bar3D","coordinateSystem":"cartesian3D","data":[{"value":["9","1","0.10"]},{"value":["9","2","0.15"]},{"value":["9","3","0.10"]},{"value":["9","4","0.07"]},{"value":["9","5","0.06"]},{"value":["9","6","0.07"]},{"value":["9","7","0.08"]},{"value":["9","8","0.10"]},{"value":["9","9","0.13"]},{"value":["9","10","0.12"]}],"itemStyle":{"opacity":0.4},"emphasis":{"itemStyle":{"color":"#313695","opacity":1}}}],"tooltip":{"trigger":"item"}},"dispose":true},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This plot is not bad at all! It has a lot of details and we can rotate the plot to get an understanding of the tranistion probabilities. Ideally I would have loved to assign the same color to the columns belonging to a decile in year t+1 but I found it difficult to achieve. I will keep exploring this.</p>
</section>
<section id="dimensional-highcharter-bar-plot" class="level2">
<h2 class="anchored" data-anchor-id="dimensional-highcharter-bar-plot">3-Dimensional <code>highcharter</code> Bar Plot</h2>
<p>As an alternative I decided to use <code>highcharter</code> library which is a wrapper for <code>highcharts</code>. However, there is no easy way to rotate the plot. So I am going to show you two plots - one without rotation and the other with. The one with rotation is actually hosted on Shinyapps.io as a Shiny app.</p>
<p>Note that in both the plots, the same color is applied to the bars for the decile in year t+1. This is shown in the legend at the bottom of the plots.</p>
<section id="static-highcharter-plot" class="level3">
<h3 class="anchored" data-anchor-id="static-highcharter-plot">Static <code>highcharter</code> plot</h3>
<div class="cell">
<div class="cell-output-display">
<div class="highchart html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ec7d77d0e1249312f9e3" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ec7d77d0e1249312f9e3">{"x":{"hc_opts":{"chart":{"reflow":true,"type":"column","options3d":{"enabled":true,"beta":20,"alpha":30,"depth":400,"viewDistance":5}},"title":{"text":"Persistence in Mutual Fund Performance"},"yAxis":{"title":{"text":null}},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"edgeColor":"#FFFFFF","groupZpadding":0,"depth":100,"groupPadding":0,"grouping":false,"frame":{"bottom":{"size":1,"color":"rgba(0,0,0,0.05)"}}},"treemap":{"layoutAlgorithm":"squarified"}},"xAxis":{"categories":["Decile_1","Decile_2","Decile_3","Decile_4","Decile_5","Decile_6","Decile_7","Decile_8","Decile_9","Decile_10"],"labels":{"rotation":0}},"colors":["#FDE725FF","#B8DE29FF","#73D055FF","#3CBB75FF","#20A387FF","#238A8DFF","#2D708EFF","#39568CFF","#453781FF","#481567FF"],"series":[{"name":"Decile_1","data":[0.2249950602647698,0.1074176789969142,0.07083180581550157,0.05291932161626273,0.05018779702590832,0.07548430193720775,0.07540946097965565,0.06590973602043712,0.09846142243004752,0.1689479786080257]},{"name":"Decile_2","data":[0.09221497727721795,0.1538025858364908,0.1262276419626835,0.07784857643367278,0.06400429250344933,0.05584502338009352,0.08572463629950236,0.09643296432964329,0.1519156799155291,0.1023785481880399]},{"name":"Decile_3","data":[0.09569255087927286,0.1137846177883676,0.1324020298300114,0.1073016728588754,0.08517936532270427,0.08042752171008684,0.08482849352679848,0.1233040022707919,0.1024775624104382,0.08710123789221735]},{"name":"Decile_4","data":[0.06010669828097214,0.08757470411312059,0.1180079881143034,0.1359077521319807,0.1201709336195002,0.1122435346884245,0.1234389002230823,0.09524079856183178,0.07332755109736783,0.07264669583754067]},{"name":"Decile_5","data":[0.05455443588223671,0.08257489941799148,0.09093715630848785,0.15444587752902,0.1597616127548674,0.1445557782231129,0.1066219230842565,0.07650676506765068,0.06348517987781883,0.06316616178615506]},{"name":"Decile_6","data":[0.08292827504445761,0.08101246045076364,0.07841472591506357,0.1155793404816448,0.1773723746742296,0.1411585074911728,0.1071557953743779,0.08451130665152805,0.06721849309902708,0.06230599498859344]},{"name":"Decile_7","data":[0.05245998814463545,0.08484043592047186,0.1107530823701931,0.1104202360097792,0.1168365782615361,0.1381429525718103,0.1269281369763761,0.1029236446210616,0.08418809864997361,0.06443771270428962]},{"name":"Decile_8","data":[0.07162616083777909,0.09122690519901566,0.1044436297682675,0.09677170962711995,0.08786217997853749,0.1036931004866877,0.1194157911796671,0.1306273062730627,0.1048910174221284,0.08949474550282359]},{"name":"Decile_9","data":[0.09760916814858724,0.1050935510331628,0.1006425222374438,0.08462471365045142,0.07879809903418672,0.08542799885485257,0.09743169294716571,0.1258397199356609,0.1299306131684139,0.1041549796177867]},{"name":"Decile_10","data":[0.1678126852400711,0.09267216124370142,0.06733941767804426,0.06418079966119314,0.05982676682508049,0.0630212806565512,0.07304516940911777,0.09870375626833192,0.1241043819292556,0.1853659448745278]}]},"theme":{"chart":{"backgroundColor":"transparent"},"colors":["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"]},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadCSV":"Download CSV","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","downloadXLS":"Download XLS","drillUpText":"◁ Back to {series.name}","exitFullscreen":"Exit from full screen","exportData":{"annotationHeader":"Annotations","categoryDatetimeHeader":"DateTime","categoryHeader":"Category"},"hideData":"Hide data table","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbolMagnitude":1000,"numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"shortWeekdays":["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],"thousandsSep":" ","viewData":"View data table","viewFullscreen":"View in full screen","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>With <code>highcharter</code>, I could assign distinct colors to the deciles. This makes it easier compared to <code>echarts4r</code> to explore transition probabilities. However, we can’t rotate this plot.</p>
<p>How to read this plot? The front row of columns belong to Decile 1 from year t+1. From left to right, we can see the Decile 1 to Decile 10 from year t. Thus, the left most column is the probability that a fund will stay in Decile 1 the next year. The second column from left is the probability that a fund will move from Decile 1 in year t to Decile 2 in year t+1. The second row of columns belongs to Decile 2 from year t+1 and so on.</p>
</section>
</section>
<section id="draggable-highcharter-bar-plot" class="level2">
<h2 class="anchored" data-anchor-id="draggable-highcharter-bar-plot">Draggable <code>highcharter</code> bar plot</h2>
<p>I decided to host my plot on Shinyapps.io as a Shiny app, which made it possible to drag or rotate the bar plot. Now you are free to play with it! The way to read the plot is the same as the static plot.</p>
<p>Check out the webapp here: <a href="https://malshe.shinyapps.io/mf-performance/" class="uri">https://malshe.shinyapps.io/mf-performance/</a></p>
<div class="cell">
<iframe src="https://malshe.shinyapps.io/mf-performance/?showcase=0" width="672" height="600px" data-external="1">
</iframe>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Figure 1 from Carhart’s article is insightful but it suffers from several issues. Using modern technology, we can recreate this figure in multiple ways. I show four ways to recreate it using JavaScript based libraries in R. Although I used data spanning 1961 to 2019, the conclusions from Carhart’s article remain the same. This shows that his findings were really robust.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-carhart1997persistence" class="csl-entry" role="listitem">
Carhart, Mark M. 1997. <span>“On Persistence in Mutual Fund Performance.”</span> <em>The Journal of Finance</em> 52 (1): 57–82.
</div>
<div id="ref-fama1993common" class="csl-entry" role="listitem">
Fama, Eugene F, and Kenneth R French. 1993. <span>“Common Risk Factors in the Returns on Stocks and Bonds.”</span> <em>Journal of Financial Economics</em> 33 (1): 3–56.
</div>
<div id="ref-jegadeesh1993returns" class="csl-entry" role="listitem">
Jegadeesh, Narasimhan, and Sheridan Titman. 1993. <span>“Returns to Buying Winners and Selling Losers: Implications for Stock Market Efficiency.”</span> <em>The Journal of Finance</em> 48 (1): 65–91.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>